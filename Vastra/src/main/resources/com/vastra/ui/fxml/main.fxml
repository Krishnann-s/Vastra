<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.text.*?>

<BorderPane xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.vastra.ui.controllers.MainController"
            stylesheets="@../css/styles.css"
            prefWidth="1200" prefHeight="800">

    <!-- TOP TOOLBAR -->
    <top>
        <VBox>
            <!-- Main Toolbar -->
            <ToolBar>
                <Button text="âž• Add Product" onAction="#onAddProduct" />
                <Button text="ðŸ“¦ Bulk Import" onAction="#onBulkImport"/>
                <Separator orientation="VERTICAL"/>
                <Button text="ðŸ‘¤ Customer" onAction="#onAddCustomer" />
                <Button text="ðŸŽ Redeem Points" onAction="#onRedeemPoints" />
                <Separator orientation="VERTICAL"/>
                <Button text="ðŸ“Š Reports" onAction="#onShowReports"/>
                <Button text="âš ï¸ Low Stock" onAction="#onShowLowStock"/>
                <Button text="â†©ï¸ Returns" onAction="#onShowReturns"/>
                <Separator orientation="VERTICAL"/>
                <Button text="âš™ï¸ Settings" onAction="#onShowSettings"/>
                <Region HBox.hgrow="ALWAYS"/>
                <Label fx:id="dateTimeLabel" text="Loading..."
                       style="-fx-text-fill: white; -fx-font-size: 13px; -fx-font-weight: bold;"/>
            </ToolBar>

            <!-- Store Info Bar -->
            <HBox style="-fx-background-color: #FFF3E0; -fx-padding: 8;" spacing="20">
                <Label fx:id="storeNameLabel" text="Store Name"
                       style="-fx-font-size: 14px; -fx-font-weight: bold; -fx-text-fill: #E65100;"/>
                <Separator orientation="VERTICAL"/>
                <Label fx:id="cashierLabel" text="Cashier: Admin"
                       style="-fx-font-size: 13px; -fx-text-fill: #E65100;"/>
                <Region HBox.hgrow="ALWAYS"/>
                <Label fx:id="invoiceLabel" text="Invoice #: INV-0001"
                       style="-fx-font-size: 13px; -fx-font-weight: bold; -fx-text-fill: #E65100;"/>
            </HBox>
        </VBox>
    </top>

    <!-- CENTER CONTENT -->
    <center>
        <VBox spacing="12" VBox.vgrow="ALWAYS">
            <padding>
                <Insets top="12" right="12" bottom="12" left="12"/>
            </padding>

            <!-- BARCODE SCANNER SECTION -->
            <VBox spacing="8" styleClass="card">
                <HBox spacing="10" alignment="CENTER_LEFT">
                    <Label text="ðŸ”" style="-fx-font-size: 24px;"/>
                    <VBox spacing="3">
                        <Label text="Scan Barcode" styleClass="label-header"/>
                        <Label text="Use barcode scanner or type product code"
                               style="-fx-font-size: 11px; -fx-text-fill: #757575;"/>
                    </VBox>
                </HBox>
                <TextField fx:id="scanField"
                           promptText="ðŸ›’ Scan or enter product barcode here..."
                           styleClass="scan-field"
                           prefHeight="50"/>
            </VBox>

            <!-- CUSTOMER INFO SECTION -->
            <HBox spacing="12" styleClass="customer-info-box">
                <VBox spacing="5" HBox.hgrow="ALWAYS">
                    <Label text="ðŸ‘¤ CUSTOMER DETAILS"
                           style="-fx-font-weight: bold; -fx-font-size: 13px; -fx-text-fill: #0D47A1;"/>
                    <HBox spacing="15">
                        <VBox spacing="3">
                            <Label text="Name:" style="-fx-font-size: 11px; -fx-text-fill: #1565C0;"/>
                            <Label fx:id="customerNameLabel" text="Walk-in Customer"
                                   style="-fx-font-weight: bold; -fx-font-size: 14px;"/>
                        </VBox>
                        <Separator orientation="VERTICAL"/>
                        <VBox spacing="3">
                            <Label text="Phone:" style="-fx-font-size: 11px; -fx-text-fill: #1565C0;"/>
                            <Label fx:id="customerPhoneLabel" text="-"
                                   style="-fx-font-weight: bold; -fx-font-size: 14px;"/>
                        </VBox>
                        <Separator orientation="VERTICAL"/>
                        <VBox spacing="3">
                            <Label text="Loyalty Points:" style="-fx-font-size: 11px; -fx-text-fill: #1565C0;"/>
                            <Label fx:id="customerPointsLabel" text="0 points"
                                   style="-fx-font-weight: bold; -fx-font-size: 14px; -fx-text-fill: #D84315;"/>
                        </VBox>
                        <Separator orientation="VERTICAL"/>
                        <VBox spacing="3">
                            <Label text="Tier:" style="-fx-font-size: 11px; -fx-text-fill: #1565C0;"/>
                            <Label fx:id="customerTierLabel" text="BRONZE"
                                   style="-fx-font-weight: bold; -fx-font-size: 14px;"/>
                        </VBox>
                        <Separator orientation="VERTICAL"/>
                        <VBox spacing="3">
                            <Label text="Total Purchases:" style="-fx-font-size: 11px; -fx-text-fill: #1565C0;"/>
                            <Label fx:id="customerPurchasesLabel" text="â‚¹0.00"
                                   style="-fx-font-weight: bold; -fx-font-size: 14px;"/>
                        </VBox>
                    </HBox>
                </VBox>
                <VBox alignment="CENTER" spacing="5">
                    <Button text="Change Customer" onAction="#onAddCustomer"
                            style="-fx-font-size: 11px;" prefWidth="120"/>
                    <Button text="Clear Customer" onAction="#onClearCustomer"
                            style="-fx-font-size: 11px; -fx-background-color: #FF5722;" prefWidth="120"/>
                </VBox>
            </HBox>

            <!-- CART TABLE SECTION -->
            <VBox VBox.vgrow="ALWAYS" spacing="8">
                <HBox alignment="CENTER_LEFT" spacing="10">
                    <Label text="ðŸ›’ CART ITEMS" styleClass="label-header"/>
                    <Label fx:id="itemCountLabel" text="(0 items)"
                           style="-fx-font-size: 13px; -fx-text-fill: #757575;"/>
                    <Region HBox.hgrow="ALWAYS"/>
                    <Button text="âž• Add Item Manually" onAction="#onAddItemManually"
                            style="-fx-font-size: 11px;"/>
                    <Button text="ðŸ—‘ï¸ Clear All" onAction="#onClearCart"
                            styleClass="button-danger" style="-fx-font-size: 11px;"/>
                </HBox>

                <TableView fx:id="cartTable" VBox.vgrow="ALWAYS">
                    <columns>
                        <TableColumn fx:id="nameColumn" text="Product Name" prefWidth="280"/>
                        <TableColumn fx:id="variantColumn" text="Variant" prefWidth="120"/>
                        <TableColumn fx:id="hsnColumn" text="HSN" prefWidth="80"/>
                        <TableColumn fx:id="qtyColumn" text="Qty" prefWidth="80"/>
                        <TableColumn fx:id="unitColumn" text="Unit" prefWidth="60"/>
                        <TableColumn fx:id="priceColumn" text="Price (â‚¹)" prefWidth="100"/>
                        <TableColumn fx:id="discountColumn" text="Disc (â‚¹)" prefWidth="80"/>
                        <TableColumn fx:id="taxColumn" text="Tax (â‚¹)" prefWidth="80"/>
                        <TableColumn fx:id="totalColumn" text="Total (â‚¹)" prefWidth="120"/>
                        <TableColumn fx:id="actionColumn" text="Actions" prefWidth="100"/>
                    </columns>
                    <placeholder>
                        <VBox alignment="CENTER" spacing="10">
                            <Label text="ðŸ›’" style="-fx-font-size: 48px; -fx-opacity: 0.3;"/>
                            <Label text="Cart is empty"
                                   style="-fx-font-size: 16px; -fx-text-fill: #757575;"/>
                            <Label text="Scan a product barcode to add items"
                                   style="-fx-font-size: 12px; -fx-text-fill: #9E9E9E;"/>
                        </VBox>
                    </placeholder>
                </TableView>
            </VBox>
        </VBox>
    </center>

    <!-- RIGHT SIDEBAR - BILLING SUMMARY -->
    <right>
        <VBox spacing="15" prefWidth="350" style="-fx-background-color: #FAFAFA; -fx-padding: 15;">
            <padding>
                <Insets top="12" right="12" bottom="12" left="12"/>
            </padding>

            <!-- BILLING SUMMARY -->
            <VBox spacing="10" styleClass="card">
                <Label text="ðŸ’° BILLING SUMMARY" styleClass="label-header"/>
                <Separator/>

                <!-- Subtotal -->
                <HBox alignment="CENTER_LEFT" spacing="10">
                    <Label text="Subtotal:" style="-fx-font-size: 14px;" HBox.hgrow="ALWAYS"/>
                    <Label fx:id="subtotalLabel" text="â‚¹0.00" styleClass="subtotal-label"/>
                </HBox>

                <!-- Item Count -->
                <HBox alignment="CENTER_LEFT" spacing="10">
                    <Label text="Total Items:" style="-fx-font-size: 13px;" HBox.hgrow="ALWAYS"/>
                    <Label fx:id="totalItemsLabel" text="0"
                           style="-fx-font-size: 13px; -fx-font-weight: bold;"/>
                </HBox>

                <!-- Tax Breakdown -->
                <Separator/>
                <Label text="Tax Breakdown:" style="-fx-font-size: 12px; -fx-font-weight: bold;"/>
                <HBox alignment="CENTER_LEFT" spacing="10">
                    <Label text="GST Amount:" style="-fx-font-size: 13px;" HBox.hgrow="ALWAYS"/>
                    <Label fx:id="taxLabel" text="â‚¹0.00" styleClass="tax-label"/>
                </HBox>
                <HBox alignment="CENTER_LEFT" spacing="10">
                    <Label text="CGST (50%):" style="-fx-font-size: 12px; -fx-text-fill: #757575;" HBox.hgrow="ALWAYS"/>
                    <Label fx:id="cgstLabel" text="â‚¹0.00" style="-fx-font-size: 12px;"/>
                </HBox>
                <HBox alignment="CENTER_LEFT" spacing="10">
                    <Label text="SGST (50%):" style="-fx-font-size: 12px; -fx-text-fill: #757575;" HBox.hgrow="ALWAYS"/>
                    <Label fx:id="sgstLabel" text="â‚¹0.00" style="-fx-font-size: 12px;"/>
                </HBox>

                <!-- Discount Section -->
                <Separator/>
                <Label text="Discounts:" style="-fx-font-size: 12px; -fx-font-weight: bold;"/>
                <HBox alignment="CENTER_LEFT" spacing="10">
                    <Label text="Item Discount:" style="-fx-font-size: 13px;" HBox.hgrow="ALWAYS"/>
                    <Label fx:id="itemDiscountLabel" text="â‚¹0.00" styleClass="discount-label"/>
                </HBox>
                <HBox alignment="CENTER_LEFT" spacing="10">
                    <Label text="Points Discount:" style="-fx-font-size: 13px;" HBox.hgrow="ALWAYS"/>
                    <TextField fx:id="pointsDiscountField" text="0"
                               prefWidth="80" promptText="0"/>
                </HBox>
                <HBox alignment="CENTER_LEFT" spacing="10">
                    <Label text="Extra Discount:" style="-fx-font-size: 13px;" HBox.hgrow="ALWAYS"/>
                    <TextField fx:id="extraDiscountField" text="0"
                               prefWidth="80" promptText="0"/>
                </HBox>
                <HBox alignment="CENTER_LEFT" spacing="10">
                    <Label text="Total Discount:" style="-fx-font-size: 13px; -fx-font-weight: bold;" HBox.hgrow="ALWAYS"/>
                    <Label fx:id="totalDiscountLabel" text="â‚¹0.00"
                           style="-fx-font-size: 13px; -fx-font-weight: bold; -fx-text-fill: #F44336;"/>
                </HBox>
            </VBox>

            <!-- GRAND TOTAL -->
            <VBox spacing="8" styleClass="totals-box">
                <HBox alignment="CENTER" spacing="10">
                    <Label text="TOTAL AMOUNT"
                           style="-fx-font-size: 16px; -fx-font-weight: bold; -fx-text-fill: #1B5E20;"/>
                </HBox>
                <HBox alignment="CENTER">
                    <Label fx:id="totalLabel" text="â‚¹0.00" styleClass="total-label"/>
                </HBox>
                <Label fx:id="totalInWordsLabel" text="Rupees Zero Only"
                       style="-fx-font-size: 11px; -fx-text-fill: #558B2F; -fx-alignment: center;"
                       alignment="CENTER" wrapText="true"/>
            </VBox>

            <!-- PAYMENT SECTION -->
            <VBox spacing="10" styleClass="card">
                <Label text="ðŸ’³ PAYMENT" styleClass="label-header"/>
                <Separator/>

                <VBox spacing="8">
                    <Label text="Payment Mode:" style="-fx-font-size: 12px;"/>
                    <ComboBox fx:id="paymentModeCombo" prefWidth="Infinity">
                        <items>
                            <javafx.collections.FXCollections fx:factory="observableArrayList">
                                <String fx:value="CASH"/>
                                <String fx:value="CARD"/>
                                <String fx:value="UPI"/>
                                <String fx:value="WALLET"/>
                                <String fx:value="CREDIT"/>
                            </javafx.collections.FXCollections>
                        </items>
                    </ComboBox>
                </VBox>

                <VBox spacing="8">
                    <Label text="Amount Received (â‚¹):" style="-fx-font-size: 12px;"/>
                    <TextField fx:id="receivedAmountField" promptText="Enter amount"/>
                </VBox>

                <HBox alignment="CENTER_LEFT" spacing="10">
                    <Label text="Change to Return:" style="-fx-font-size: 13px; -fx-font-weight: bold;" HBox.hgrow="ALWAYS"/>
                    <Label fx:id="changeLabel" text="â‚¹0.00"
                           style="-fx-font-size: 16px; -fx-font-weight: bold; -fx-text-fill: #FF6F00;"/>
                </HBox>
            </VBox>

            <!-- NOTES -->
            <VBox spacing="8">
                <Label text="ðŸ“ Notes (Optional):" style="-fx-font-size: 12px;"/>
                <TextArea fx:id="notesArea" promptText="Add any notes for this sale..."
                          prefRowCount="2" wrapText="true"/>
            </VBox>

            <!-- ACTION BUTTONS -->
            <VBox spacing="10">
                <Button text="âœ“ COMPLETE SALE (F12)"
                        onAction="#onCompleteSale"
                        styleClass="button-primary"
                        prefHeight="50"
                        maxWidth="Infinity"/>

                <HBox spacing="8">
                    <Button text="Hold Sale (F9)" onAction="#onHoldSale"
                            styleClass="button-secondary"
                            HBox.hgrow="ALWAYS" maxWidth="Infinity"/>
                    <Button text="Cancel (ESC)" onAction="#onClearCart"
                            styleClass="button-danger"
                            HBox.hgrow="ALWAYS" maxWidth="Infinity"/>
                </HBox>

                <HBox spacing="8">
                    <Button text="ðŸ“„ Print Bill" onAction="#onPrintBill"
                            HBox.hgrow="ALWAYS" maxWidth="Infinity"/>
                    <Button text="ðŸ“§ Email" onAction="#onEmailBill"
                            HBox.hgrow="ALWAYS" maxWidth="Infinity"/>
                </HBox>
            </VBox>

            <!-- Quick Stats -->
            <VBox spacing="5" style="-fx-background-color: #FFF3E0; -fx-padding: 10; -fx-background-radius: 5;">
                <Label text="ðŸ“Š Today's Stats" style="-fx-font-weight: bold; -fx-font-size: 12px;"/>
                <HBox spacing="10">
                    <Label text="Sales:" style="-fx-font-size: 11px;"/>
                    <Label fx:id="todaySalesCountLabel" text="0"
                           style="-fx-font-weight: bold; -fx-font-size: 11px;"/>
                </HBox>
                <HBox spacing="10">
                    <Label text="Revenue:" style="-fx-font-size: 11px;"/>
                    <Label fx:id="todayRevenueLabel" text="â‚¹0.00"
                           style="-fx-font-weight: bold; -fx-font-size: 11px;"/>
                </HBox>
            </VBox>
        </VBox>
    </right>

    <!-- BOTTOM STATUS BAR -->
    <bottom>
        <HBox style="-fx-background-color: #37474F; -fx-padding: 8;" spacing="15">
            <Label fx:id="statusLabel" text="Ready"
                   style="-fx-text-fill: #B2DFDB; -fx-font-size: 12px;"/>
            <Region HBox.hgrow="ALWAYS"/>
            <Label text="F1: Help" style="-fx-text-fill: white; -fx-font-size: 11px;"/>
            <Separator orientation="VERTICAL"/>
            <Label text="F2: Customer" style="-fx-text-fill: white; -fx-font-size: 11px;"/>
            <Separator orientation="VERTICAL"/>
            <Label text="F9: Hold" style="-fx-text-fill: white; -fx-font-size: 11px;"/>
            <Separator orientation="VERTICAL"/>
            <Label text="F12: Complete" style="-fx-text-fill: white; -fx-font-size: 11px;"/>
            <Separator orientation="VERTICAL"/>
            <Label text="ESC: Cancel" style="-fx-text-fill: white; -fx-font-size: 11px;"/>
        </HBox>
    </bottom>
</BorderPane>